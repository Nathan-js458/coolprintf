#!/bin/sh

# Verifica se o compilador C está disponível
if ! command -v cc >/dev/null 2>&1 && ! command -v gcc >/dev/null 2>&1; then
  echo "Error: No compiler found. Please install one if you can."
  exit 1
fi

CC=$(command -v gcc || command -v cc)

# Diretórios padrão
prefix="/usr/local"

# Argumentos de linha de comando
for arg in "$@"; do
  case $arg in
    --prefix=*)
      prefix="${arg#*=}"
      ;;
    *)
      echo "Unknown option: $arg"
      exit 1
      ;;
  esac
done

echo "Using compiler: $CC"
echo "Install folder: $prefix"

# Gera um Makefile básico
cat > Makefile <<EOF
CC = $CC
PREFIX = $prefix

all:
	\$(CC) -o cprintf cprintf.c

install:
	mkdir -p \$(PREFIX)/bin
	cp cprintf \$(PREFIX)/bin/

clean:
	rm -f cprintf
EOF

echo "Makefile created"
